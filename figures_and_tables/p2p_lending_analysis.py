import numpy as np
import pandas as pd
import functions.make_data as md
import functions.rand_test as rt
import matplotlib.pyplot as plt
from sklearn.model_selection import KFold
import xarray as xr
import functions.diff_in_diff as did
import functions.did_ss_corr as ds

def did_search_n_split(agged_set, unagged_set, search_vars, splits = 20, test_side = 1, random_state = None):
    
    if random_state: 
        kf = KFold(n_splits=splits, shuffle=True, random_state=random_state)
    else: 
        kf = KFold(n_splits=splits, shuffle=True)
    
    # get just the outcome variables in agged_set
    unagged_set = unagged_set.sel({'stream':[i for i in agged_set.stream.to_numpy()]})

    # set aside array for estimated treatment effects:
    effects = []
    ses = []
    ps = []
    subsets = []

    for search_ix, te_ix in kf.split(unagged_set.unit.to_numpy()): # search_ix, te_ix = next(kf.split(unagged_set.unit.to_numpy()))

        # use ix to subset on units:
        search_set = unagged_set.sel({'unit':unagged_set["unit"][search_ix]})
        te_set = unagged_set.sel({'unit':unagged_set["unit"][te_ix]})

        result = ds.cor_search(data = search_set, search_vars=search_vars, binned = True)

        # extract score and discovered set: 
        score = result['score']
        subset = result['selected']

        # get just selected set from hold out data: 
        te_subset = md.subset_by_covs(xr_data=te_set, subset = subset)
        
        te, se, p = did.diff_in_diff(te_subset, model_type = 'twfe')

        effects.append(te)
        ses.append(se)
        ps.append(p)
        subsets.append(subset)

    # return {'effects':effects, 'ses':ses, 'ps':ps, 'subsets':pd.DataFrame(list(subsets))}
    return pd.DataFrame({'effects':effects, 'ses':ses, 'ps':ps}).join(pd.DataFrame(list(subsets)))        
    

if __name__ == "__main__":

    # LOAD DATA AND PREPROCESS #################################################################
    data = pd.read_csv("data/wando_cleaned.csv", index_col=0)
    x_names = ['employed_individuals', 'medianhouseholdincome', 'branch_count_percapita', 'internet_access_score']

    # log the outcomes of interest that are not already logged: 
    data.loc[data["stream"] == "bankruptcy_per_capita", "outcome"] = np.log(data[data["stream"] == "bankruptcy_per_capita"]["outcome"] + 1)
    data.loc[data["stream"] == "business_bankruptcy_percapita", "outcome"] = np.log(data[data["stream"] == "business_bankruptcy_percapita"]["outcome"] + 1)
    data.loc[data["stream"] == "nonbusiness_bankruptcy_percapita", "outcome"] = np.log(data[data["stream"] == "nonbusiness_bankruptcy_percapita"]["outcome"] + 1)
    data.loc[data["stream"] == "bankruptcy_percapita_lowliab", "outcome"] = np.log(data[data["stream"] == "bankruptcy_percapita_lowliab"]["outcome"] + 1)
    data.loc[data["stream"] == "bankruptcy_percapita_highliab", "outcome"] = np.log(data[data["stream"] == "bankruptcy_percapita_highliab"]["outcome"] + 1)
    data.loc[data["stream"] == "bankruptcy_percapita_highassets", "outcome"] = np.log(data[data["stream"] == "bankruptcy_percapita_highassets"]["outcome"] + 1)
    data.loc[data["stream"] == "bankruptcy_percapita_lowassets", "outcome"] = np.log(data[data["stream"] == "bankruptcy_percapita_lowassets"]["outcome"] + 1)

    # get an unaggregated version for diff in diff: 
    xr_data = md.df_to_dndset(data, diff=False, agg = False, searchvars = ['employed_individuals', 'medianhouseholdincome', 'internet_access_score', 'branch_count_percapita'])

    xr_data['internet_access_score'] = xr_data.internet_access_score.astype(str)





    # ANALYSIS ###################################################################################


    # overall bank ate
    S = {'stream': ['bankruptcy_per_capita']}
    subset = md.subset_by_covs(xr_data, subset = S) # get subset, which is all counties and all times, but just the overall bankruptcy outcome.
    did.diff_in_diff(subset, model_type = 'twfe')


    ### overall bankruptcy didscan (TABLE 1 ROW 1) ###
    ovrall_bank = xr_data.sel({'stream':'bankruptcy_per_capita'}).expand_dims('stream') 
    neworder = ["stream"]
    neworder.extend(list(ovrall_bank.dims)[:-1])
    neworder.extend([i for i in list(ovrall_bank.variables) if i not in list(ovrall_bank.dims)])
    ovrall_bank = ovrall_bank[neworder] # reorder dims so stream is first

    # get best subset and its score: 
    result = ds.cor_search(data = ovrall_bank, search_vars = x_names, binned = True)

    # estimate treatment effect at the best set: 
    te_output = did_search_n_split(ovrall_bank, xr_data, search_vars = x_names, splits = 5)
    te_output[['employed_individuals','medianhouseholdincome','branch_count_percapita','internet_access_score','effects']]

    # get null distribution using permutation test and get one-sided p value: 
    rtout_overall = rt.rand_test(result, ovrall_bank, n_samples =500, search_covs = x_names, n_processes = 7)
    np.mean(result['score'] < rtout_overall)
    # optionally save randomization distribution: 
    # pd.DataFrame({"null_scores" : rtout}).to_csv("nullscores.csv")



    ### bankruptcy by liability (TABLE 1 ROW 2) ### 
    liab_data = xr_data.sel({'stream':['bankruptcy_percapita_highliab', 'bankruptcy_percapita_lowliab']})

    # run didscan on liability outcomes:
    result = ds.cor_search(data = liab_data, search_vars = x_names, binned = True)

    # get null distribution using permutation test and get one-sided p value: 
    rtout_liab = rt.rand_test(result, liab_data, n_samples = 1000, search_covs = x_names, n_processes = 7, print_count = True)
    np.mean(result['score'] < rtout_liab)


    ### bankruptcy by asset (TABLE 2 ROW 3) ###
    asset_data = xr_data.sel({'stream':['bankruptcy_percapita_highassets', 'bankruptcy_percapita_lowassets']})

    # run didscan on liability outcomes:
    result = ds.cor_search(data = asset_data, search_vars = x_names, binned = True)

    # get null distribution using permutation test and get one-sided p value: 
    rtout_asset = rt.rand_test(result, liab_data, n_samples = 1000, search_covs = x_names, n_processes = 7, print_count = True)
    np.mean(result['score'] < rtout_asset)



    # TABLE 3: evaluate nearby subsets to the subset discovered for overall bankruptcy rate 
    S = {'employed_individuals': ['1', '2'], 'medianhouseholdincome': ['2'], 
                'internet_access_score': ['2'], 'branch_count_percapita': ['1']}
    ds.get_score_given_set(ovrall_bank, S, search_vars = x_names, binned = True)


    S = {'employed_individuals': ['1', '2'], 'medianhouseholdincome': ['2'], 
                'internet_access_score': ['1', '2'], 'branch_count_percapita': ['1','2']}
    ds.get_score_given_set(ovrall_bank, S, search_vars = x_names, binned = True)


    S = {'employed_individuals': ['1', '2'], 'medianhouseholdincome': ['1', '2'], 
                'internet_access_score': ['1', '2'], 'branch_count_percapita': ['2']}
    ds.get_score_given_set(ovrall_bank, S, search_vars = x_names, binned = True)


    S = {'employed_individuals': ['1', '2'], 'medianhouseholdincome': ['1', '2'], 
                'internet_access_score': ['1', '2'], 'branch_count_percapita': ['1']}
    ds.get_score_given_set(ovrall_bank, S, search_vars = x_names, binned = True)





    #  NOTES: 

    # outcome: log_bankruptcy, covariates: ['employed_individuals', 'medianhouseholdincome', 'internet_access_score']
    # Based on a null distribution (rearranged), this appears to find a pretty significant result


    # outcome: log_bankruptcy, covariates: ['employed_individuals', 'medianhouseholdincome', 'internet_access_score', 'branch_count_percapita']
    # Based on a null distribution (rearranged), this appears to find a pretty significant result

    # this one is also a winner at a score round 16: 
    # {'stream': ['bankruptcy_percapita_highliab'], 'employed_individuals': ['1', '2'], 'medianhouseholdincome': ['2'], 'internet_access_score': ['2'], 'branch_count_percapita': ['1']}






    import seaborn as sns
    import matplotlib.pyplot as plt

    real_score = result['score'] #7.30516352 # 

    rtout.sort()
    n_samples = len(rtout)

    sns.histplot(rtout, bins=20, kde=False)
    plt.xlabel('F-Score of S*')
    #plt.ylabel('Frequency')
    plt.title('')
    # Draw line at true score
    y_min, y_max = plt.gca().get_ylim()
    x_min, x_max = plt.gca().get_xlim()
    x_range = x_max - x_min
    plt.axvline(real_score, color='red', linestyle='--', linewidth=1)
    plt.text(real_score-0.05*x_range, 0.9*y_max, 'data', ha='center')
    # Draw line at 95%
    ninety5pct = rtout[(round(0.95 * n_samples)-1)]
    plt.axvline(ninety5pct, color = 'blue', linestyle='--', linewidth=1)
    plt.text(ninety5pct-0.05*x_range, 0.95*y_max, '95%', ha='center')
    plt.show()












    # TODO: DELETE. Below is the null distribution for the overall bankruptcy rate analysis 
    rtout = np.array([0.02136258, 0.04422628, 0.05164332, 0.05327139, 0.05973252,
       0.06431069, 0.07412451, 0.07564537, 0.08909124, 0.08931581,
       0.095285  , 0.0988495 , 0.1087172 , 0.11076062, 0.12066278,
       0.12334692, 0.12538212, 0.13483177, 0.14231541, 0.14574441,
       0.15105669, 0.15337507, 0.15422455, 0.15766556, 0.15917356,
       0.1664533 , 0.17080405, 0.17211664, 0.17234016, 0.17669854,
       0.17883332, 0.17968678, 0.19210408, 0.19612648, 0.20106467,
       0.20514471, 0.20688107, 0.20780488, 0.21167127, 0.21322449,
       0.2166218 , 0.21943962, 0.22334832, 0.22602244, 0.22794529,
       0.23326589, 0.24117815, 0.2526875 , 0.25336718, 0.25996228,
       0.26123187, 0.26775877, 0.26952107, 0.27240117, 0.28658917,
       0.29014486, 0.29125323, 0.29449386, 0.29834526, 0.30138734,
       0.3054239 , 0.31165358, 0.31311883, 0.3211023 , 0.32410174,
       0.32466997, 0.32588593, 0.3260491 , 0.32655442, 0.32762777,
       0.33657682, 0.34537438, 0.34882304, 0.36703358, 0.36847125,
       0.37779574, 0.40834758, 0.41017573, 0.41034305, 0.41657025,
       0.41935079, 0.42277025, 0.42703061, 0.42721705, 0.44683319,
       0.4476839 , 0.44864031, 0.4511125 , 0.45469211, 0.45936117,
       0.45980421, 0.46079416, 0.47416023, 0.47445899, 0.47500572,
       0.4848596 , 0.48689252, 0.50840461, 0.50995733, 0.51951066,
       0.52637052, 0.52646249, 0.53237943, 0.53353694, 0.53358994,
       0.53496071, 0.53972159, 0.54191017, 0.54644728, 0.55490422,
       0.56034912, 0.56618413, 0.58033162, 0.58254286, 0.58309398,
       0.58580299, 0.59219736, 0.60405972, 0.60854701, 0.61574317,
       0.61628158, 0.61889841, 0.6299023 , 0.64007604, 0.64156198,
       0.6424661 , 0.64471792, 0.64589486, 0.66203314, 0.66284365,
       0.66334143, 0.66399796, 0.66502398, 0.66614931, 0.66690564,
       0.66864322, 0.68265861, 0.68473963, 0.68495668, 0.68547836,
       0.6932127 , 0.71062346, 0.71368715, 0.72115343, 0.72916148,
       0.72958656, 0.73538056, 0.742807  , 0.74751024, 0.75262289,
       0.75798564, 0.76071305, 0.76427108, 0.7654763 , 0.76650934,
       0.76883586, 0.77192094, 0.77286548, 0.77933526, 0.79096126,
       0.79972291, 0.81242922, 0.81256805, 0.81736896, 0.81996652,
       0.82025314, 0.82674781, 0.82721227, 0.85462985, 0.8607684 ,
       0.86956919, 0.88349966, 0.8881615 , 0.888672  , 0.89537925,
       0.89747562, 0.89782156, 0.90641579, 0.9125313 , 0.91355411,
       0.91840677, 0.91972851, 0.93781748, 0.96148032, 0.96299897,
       0.96369104, 0.96682452, 0.96810705, 0.96930073, 0.98801129,
       0.99141168, 0.99218041, 0.99553413, 1.00484972, 1.00877213,
       1.01010288, 1.01141264, 1.01242321, 1.01424008, 1.0224557 ,
       1.03445332, 1.03796458, 1.0465172 , 1.05561842, 1.05953933,
       1.05980526, 1.0627577 , 1.06408787, 1.06522342, 1.06711931,
       1.06745171, 1.07080282, 1.07327067, 1.08318428, 1.10167251,
       1.10521858, 1.11324299, 1.11448008, 1.12370541, 1.12807237,
       1.13066544, 1.13110829, 1.13270883, 1.13277088, 1.1329735 ,
       1.14283315, 1.14342164, 1.14710545, 1.15696469, 1.15925777,
       1.16484621, 1.17053761, 1.17849557, 1.1794671 , 1.18319121,
       1.18734765, 1.18912523, 1.20393305, 1.20834249, 1.21112789,
       1.2117352 , 1.22630379, 1.2288619 , 1.23167856, 1.23955322,
       1.24291691, 1.24525219, 1.25656025, 1.25719938, 1.26118255,
       1.26306625, 1.26333218, 1.26413605, 1.29106209, 1.29569913,
       1.3130883 , 1.33025596, 1.33412851, 1.33419034, 1.3342605 ,
       1.33517089, 1.33656989, 1.3374801 , 1.33752828, 1.33836584,
       1.34963538, 1.35543219, 1.36030182, 1.36833608, 1.39367453,
       1.40188205, 1.40210895, 1.40424782, 1.41354402, 1.4135633 ,
       1.42111424, 1.42163178, 1.42411134, 1.43178727, 1.4504232 ,
       1.46477888, 1.46602583, 1.4666547 , 1.47585769, 1.4992742 ,
       1.50017435, 1.50029267, 1.52094995, 1.53748883, 1.54290119,
       1.54586882, 1.55951635, 1.57586174, 1.57781614, 1.58234222,
       1.58322737, 1.59310519, 1.59778989, 1.60564575, 1.61581454,
       1.62334052, 1.64766952, 1.64792665, 1.65256405, 1.66953373,
       1.68131406, 1.68712183, 1.69869639, 1.70282773, 1.70919552,
       1.71504095, 1.72348524, 1.728524  , 1.72944358, 1.75106779,
       1.7657777 , 1.77668513, 1.78706235, 1.80021763, 1.80519474,
       1.81351758, 1.81717462, 1.82725656, 1.83736165, 1.84223279,
       1.84389439, 1.8565836 , 1.86244462, 1.88582536, 1.88615314,
       1.90159716, 1.90173878, 1.936196  , 1.95642119, 1.97557221,
       1.97974202, 1.98118663, 1.99365301, 1.99970995, 2.00323602,
       2.00712601, 2.01352943, 2.01460246, 2.0165376 , 2.0166417 ,
       2.02178898, 2.02519158, 2.03707205, 2.03888509, 2.0634011 ,
       2.073276  , 2.07917008, 2.0853591 , 2.09804559, 2.10005636,
       2.10307921, 2.1165207 , 2.14003629, 2.14176428, 2.14246587,
       2.144604  , 2.16037153, 2.17965059, 2.18828199, 2.19760817,
       2.19843764, 2.20565907, 2.21851943, 2.2185945 , 2.23118247,
       2.23504835, 2.24000581, 2.2437238 , 2.24438321, 2.24457756,
       2.27830588, 2.28771496, 2.31849395, 2.32735491, 2.33241   ,
       2.3415127 , 2.36018811, 2.36814432, 2.37310429, 2.39098687,
       2.40302421, 2.41932462, 2.43870832, 2.44053811, 2.45567918,
       2.50990248, 2.51400813, 2.52095441, 2.53647526, 2.53831774,
       2.58874407, 2.59383561, 2.60838249, 2.62090304, 2.62436726,
       2.62846815, 2.63161794, 2.67587677, 2.67895598, 2.68017418,
       2.68583762, 2.72516633, 2.72811069, 2.75623498, 2.75759216,
       2.76048512, 2.76639671, 2.77122073, 2.77191909, 2.8269263 ,
       2.8439945 , 2.92203788, 2.93825076, 2.9543047 , 2.96269774,
       2.96497956, 2.96821585, 3.00593018, 3.04286445, 3.06724767,
       3.07740535, 3.09496804, 3.12731123, 3.13435222, 3.15149013,
       3.17368354, 3.18733141, 3.20572236, 3.223771  , 3.24054445,
       3.24556305, 3.26357178, 3.29251357, 3.32926925, 3.34109379,
       3.35231031, 3.35470174, 3.39556492, 3.41583235, 3.42155335,
       3.43199949, 3.43446306, 3.4844352 , 3.52499784, 3.54303704,
       3.6083991 , 3.61985579, 3.6332211 , 3.65367709, 3.68456255,
       3.89089228, 3.9061036 , 3.92256464, 3.98287765, 3.99717487,
       4.00722093, 4.02852903, 4.06704878, 4.14449707, 4.1810812 ,
       4.193474  , 4.27261476, 4.35821761, 4.39244654, 4.40477083,
       4.42535774, 4.49046676, 4.52889678, 4.56823309, 4.64757289,
       4.75059906, 4.85754886, 4.91298039, 4.92855414, 5.13401818,
       5.16397132, 5.2261684 , 5.28419017, 5.32192912, 5.33443091,
       5.37363622, 5.44840122, 5.50153273, 5.51607275, 5.63060803,
       5.6844814 , 6.22284825, 6.29612168, 6.60137759, 6.71426849,
       6.86458623, 6.87721439, 7.09508318, 7.37724365, 8.02605671,
       0.0811977 , 0.08341754, 0.1046158 , 0.10664977, 0.10969081,
       0.11279644, 0.11312984, 0.11387762, 0.11462898, 0.12812873,
       0.13159659, 0.13613139, 0.14500776, 0.14840755, 0.15372348,
       0.16127814, 0.16308636, 0.17394159, 0.18012838, 0.18164717,
       0.18293588, 0.1844617 , 0.19071444, 0.19350867, 0.19777231,
       0.21354095, 0.21779064, 0.21936943, 0.22540796, 0.23892549,
       0.23950228, 0.23997675, 0.24887942, 0.25248118, 0.25564227,
       0.25575993, 0.26068925, 0.27188043, 0.2769767 , 0.27933075,
       0.28512681, 0.29195093, 0.29521536, 0.3012418 , 0.30161932,
       0.31205577, 0.31351248, 0.31368336, 0.31453107, 0.31877908,
       0.32143696, 0.32324425, 0.32566333, 0.33453677, 0.33688991,
       0.33708942, 0.3381836 , 0.33872429, 0.34184681, 0.34502225,
       0.3469582 , 0.35432314, 0.35473492, 0.35984215, 0.36938573,
       0.37658757, 0.37843681, 0.37978466, 0.38164348, 0.38443168,
       0.38461271, 0.38561111, 0.38574701, 0.38593401, 0.39023293,
       0.39088425, 0.39319708, 0.39528954, 0.39817543, 0.40198172,
       0.40570061, 0.41071152, 0.41792966, 0.41820968, 0.42071813,
       0.42776039, 0.42979728, 0.43054814, 0.43279128, 0.4381678 ,
       0.43987919, 0.44477942, 0.44835286, 0.45085706, 0.45591192,
       0.45669637, 0.45893533, 0.45897466, 0.46794672, 0.47934797,
       0.48102969, 0.4814187 , 0.48541268, 0.48696383, 0.49325706,
       0.4933273 , 0.49736064, 0.50444202, 0.50695932, 0.51982522,
       0.53152127, 0.53504881, 0.53508861, 0.53701196, 0.53722691,
       0.54154131, 0.54205743, 0.5479342 , 0.56405758, 0.56709454,
       0.57038482, 0.57248114, 0.57499492, 0.57723805, 0.58010757,
       0.59489959, 0.59849252, 0.60254143, 0.60928529, 0.61062724,
       0.61147234, 0.61219925, 0.61242719, 0.6128428 , 0.61598754,
       0.61621811, 0.61682539, 0.61694875, 0.61739815, 0.63056788,
       0.63908519, 0.6453663 , 0.65564566, 0.65795362, 0.66381656,
       0.66569854, 0.66632636, 0.67285524, 0.67975299, 0.69279936,
       0.6938589 , 0.69487548, 0.70410864, 0.70674984, 0.70890618,
       0.7096282 , 0.71671389, 0.72134605, 0.73132076, 0.73252124,
       0.73391051, 0.73508605, 0.74760627, 0.75725762, 0.76323711,
       0.7665552 , 0.7709025 , 0.78061098, 0.78360077, 0.79698999,
       0.80057996, 0.80208164, 0.80302032, 0.80414506, 0.80509558,
       0.8058549 , 0.8101981 , 0.81524731, 0.81754932, 0.82170309,
       0.83141924, 0.83731509, 0.84517242, 0.84520547, 0.84761904,
       0.85007422, 0.8570989 , 0.86011228, 0.86232121, 0.86619951,
       0.87239875, 0.88255923, 0.88456896, 0.88688509, 0.90836722,
       0.91692175, 0.918457  , 0.92750966, 0.9285791 , 0.93509076,
       0.93682014, 0.93849683, 0.93920884, 0.94507522, 0.9485644 ,
       0.94993017, 0.95377141, 0.95433568, 0.95954833, 0.95974066,
       0.96326163, 0.96521792, 0.97377566, 0.97746519, 0.98326576,
       0.98424247, 0.99919332, 1.00109655, 1.01064584, 1.0218522 ,
       1.02667359, 1.02990326, 1.03195952, 1.03283091, 1.03842822,
       1.03983303, 1.04805734, 1.05005458, 1.05039002, 1.05275228,
       1.05289467, 1.0607731 , 1.06133893, 1.06214424, 1.06603953,
       1.06837228, 1.07025592, 1.08065406, 1.08183621, 1.08317893,
       1.0900978 , 1.10057677, 1.11290909, 1.12619991, 1.13100409,
       1.13498021, 1.14535443, 1.15753929, 1.16264955, 1.16717798,
       1.16855279, 1.16945514, 1.17000482, 1.19986617, 1.20926594,
       1.21006136, 1.2137188 , 1.21416547, 1.21608361, 1.22051654,
       1.22571544, 1.22939311, 1.2296034 , 1.2303635 , 1.23508781,
       1.24816318, 1.24904387, 1.25174195, 1.26452989, 1.26712991,
       1.27181534, 1.27287076, 1.28430923, 1.29046549, 1.29630472,
       1.29635326, 1.3175538 , 1.3176566 , 1.31808332, 1.32080717,
       1.32106279, 1.32127163, 1.34052604, 1.34663585, 1.34961294,
       1.36687552, 1.37963624, 1.38195172, 1.38429935, 1.39117791,
       1.40686429, 1.41889791, 1.41944057, 1.44536595, 1.44731795,
       1.47010685, 1.47771202, 1.47852848, 1.48264626, 1.48276813,
       1.48615288, 1.50010156, 1.50429692, 1.51452071, 1.51773079,
       1.52916001, 1.52966537, 1.53170571, 1.53177597, 1.53511762,
       1.53994581, 1.55435923, 1.55449714, 1.55525201, 1.56677072,
       1.57289851, 1.57362474, 1.59929321, 1.622425  , 1.62384421,
       1.62820803, 1.63498844, 1.64449165, 1.6471554 , 1.65227915,
       1.6532377 , 1.65398962, 1.65861506, 1.67293733, 1.68548938,
       1.69146616, 1.70927781, 1.72714477, 1.74074943, 1.74806787,
       1.7520021 , 1.7739494 , 1.78417035, 1.78773675, 1.79202392,
       1.79610488, 1.79709763, 1.79747128, 1.79957116, 1.8121378 ,
       1.81326927, 1.81897547, 1.83431584, 1.84575447, 1.84657151,
       1.84938841, 1.85118877, 1.85936424, 1.87398296, 1.87728388,
       1.91868365, 1.94043043, 1.9440493 , 1.96589439, 1.97980351,
       1.99610442, 2.0028323 , 2.00804251, 2.01064767, 2.01108638,
       2.01463994, 2.02341286, 2.03280619, 2.0357635 , 2.03756793,
       2.03885556, 2.0468598 , 2.06490855, 2.07946148, 2.08089253,
       2.09542397, 2.10782295, 2.11897039, 2.12523888, 2.12555191,
       2.12570456, 2.14344761, 2.14695086, 2.17523621, 2.20915392,
       2.22263687, 2.23879804, 2.26566169, 2.27638494, 2.27802774,
       2.30389624, 2.31437747, 2.32087882, 2.34820346, 2.34908411,
       2.3543759 , 2.36547823, 2.37394521, 2.39223848, 2.40465788,
       2.41910498, 2.4211488 , 2.48864412, 2.49094923, 2.50596222,
       2.50915876, 2.52425026, 2.53065724, 2.53492073, 2.55428357,
       2.5829506 , 2.60310404, 2.62011084, 2.6204584 , 2.62397584,
       2.63811601, 2.64629135, 2.65759347, 2.66133667, 2.69752314,
       2.79529876, 2.82135907, 2.8315793 , 2.84150108, 2.87391648,
       2.88487146, 2.88521562, 2.89589023, 2.90692294, 2.93258952,
       2.94689374, 2.94921179, 2.96675523, 2.9818683 , 2.99717683,
       3.02701291, 3.03576273, 3.13423514, 3.15412376, 3.1903356 ,
       3.23368835, 3.24133471, 3.26627163, 3.27387093, 3.29424121,
       3.30301241, 3.34991592, 3.35986433, 3.43013675, 3.43785635,
       3.46360124, 3.50708287, 3.56374311, 3.57611863, 3.59360917,
       3.61866179, 3.63026207, 3.63397756, 3.66243971, 3.66357799,
       3.69537278, 3.71272229, 3.73995773, 3.74919106, 3.75806424,
       3.87641798, 3.9096359 , 4.06514683, 4.15357437, 4.24809326,
       4.30862878, 4.32694528, 4.32932009, 4.42243939, 4.54054414,
       4.54416162, 4.54505428, 4.81103169, 4.90602886, 5.05445419,
       5.06747294, 5.21531418, 5.30551428, 5.42434693, 5.52024465,
       5.52591834, 5.57585811, 5.73271142, 5.83788676, 5.88728046,
       6.07534801, 6.13761351, 6.20813399, 6.24437539, 6.72351157,
       7.39142192, 7.70755113, 8.00751583, 8.1941348 , 8.26835295])




# Liability NULL DIST: 

# array([ 0.04856497,  0.06613514,  0.07160463,  0.09409603,  0.09824858,
#         0.10360422,  0.10867629,  0.11587256,  0.12393307,  0.12407746,
#         0.13453123,  0.13819406,  0.14436133,  0.14613785,  0.15275935,
#         0.17461912,  0.18961232,  0.19313556,  0.19430802,  0.19615003,
#         0.20083649,  0.21384337,  0.21428354,  0.21713525,  0.22007307,
#         0.22147612,  0.22853848,  0.24151322,  0.24496516,  0.24900842,
#         0.25347469,  0.25399439,  0.25544197,  0.25803218,  0.26441178,
#         0.27053223,  0.28540694,  0.2861768 ,  0.29114439,  0.29522676,
#         0.29573589,  0.3122082 ,  0.31845125,  0.32392476,  0.32434709,
#         0.33443672,  0.34131901,  0.34205227,  0.34334348,  0.35271642,
#         0.36605448,  0.3669551 ,  0.36779642,  0.36921952,  0.37281174,
#         0.37369586,  0.37376397,  0.37764496,  0.38210265,  0.38344075,
#         0.39222819,  0.39308536,  0.39651186,  0.39777925,  0.40012932,
#         0.40817029,  0.41401588,  0.41633901,  0.41659669,  0.41725192,
#         0.41893788,  0.42956162,  0.43117653,  0.43344318,  0.44160223,
#         0.44299723,  0.45146512,  0.45169856,  0.45690961,  0.46175939,
#         0.4630339 ,  0.4668439 ,  0.4747757 ,  0.47501619,  0.47724345,
#         0.48505995,  0.4870154 ,  0.48968836,  0.49009909,  0.49435402,
#         0.5000933 ,  0.50830044,  0.51253608,  0.51397371,  0.51615919,
#         0.51795913,  0.52213228,  0.52222453,  0.52295987,  0.52372548,
#         0.53854971,  0.54631221,  0.55615258,  0.56135321,  0.57205038,
#         0.57554429,  0.58099764,  0.58387053,  0.58736542,  0.58878655,
#         0.58987074,  0.59580103,  0.60109897,  0.60670381,  0.60796467,
#         0.61725274,  0.62826711,  0.63346939,  0.64354117,  0.64811557,
#         0.6483502 ,  0.64943232,  0.65041084,  0.65867069,  0.66532124,
#         0.67708537,  0.67719362,  0.67755294,  0.68397569,  0.69088752,
#         0.69166141,  0.69257495,  0.69925857,  0.70907871,  0.71253001,
#         0.71310379,  0.71406175,  0.71786035,  0.71870338,  0.72028794,
#         0.72389717,  0.72743908,  0.72891535,  0.73722136,  0.74434474,
#         0.74502798,  0.74899155,  0.75064665,  0.75500474,  0.75612496,
#         0.75660903,  0.76499628,  0.76666105,  0.76902354,  0.77018461,
#         0.78652198,  0.79012618,  0.79368863,  0.79824333,  0.8052468 ,
#         0.8056435 ,  0.80983541,  0.81583725,  0.81752418,  0.81890707,
#         0.819953  ,  0.82092827,  0.82130463,  0.82201787,  0.83468239,
#         0.84044953,  0.84064501,  0.84070677,  0.84603439,  0.84873391,
#         0.85155675,  0.85266413,  0.85292314,  0.85664752,  0.85672061,
#         0.85736971,  0.86923261,  0.86975903,  0.87224406,  0.87322933,
#         0.87457714,  0.87709091,  0.87957993,  0.88151361,  0.88871174,
#         0.89813004,  0.90288804,  0.90324583,  0.90604461,  0.90948946,
#         0.91304265,  0.92797461,  0.93233117,  0.93734936,  0.94308025,
#         0.94765433,  0.95227285,  0.95578796,  0.95862854,  0.96243868,
#         0.9693995 ,  0.98500829,  0.98738276,  0.99134084,  0.99539203,
#         1.00254049,  1.00481401,  1.00937803,  1.00977467,  1.01163542,
#         1.01640264,  1.01934293,  1.02120661,  1.02440079,  1.0253454 ,
#         1.03102705,  1.03873884,  1.04253672,  1.04460263,  1.04656085,
#         1.06348422,  1.07409173,  1.07588186,  1.07983162,  1.09437904,
#         1.09532395,  1.09952524,  1.10175822,  1.10780651,  1.11138195,
#         1.11488155,  1.11557629,  1.11984933,  1.12437124,  1.13105852,
#         1.14068784,  1.14965811,  1.15160713,  1.15615825,  1.1659388 ,
#         1.16681276,  1.1819182 ,  1.1831889 ,  1.18809846,  1.18961512,
#         1.19179073,  1.19354333,  1.19844905,  1.2061144 ,  1.20810019,
#         1.20836912,  1.20947193,  1.21063262,  1.21407825,  1.21859127,
#         1.22459508,  1.22936933,  1.23190599,  1.23419216,  1.24532094,
#         1.25094819,  1.25193556,  1.25265485,  1.25936888,  1.26251018,
#         1.2690034 ,  1.26926929,  1.27126229,  1.27430422,  1.27702288,
#         1.27755104,  1.27846975,  1.28063472,  1.28129726,  1.28334446,
#         1.28352181,  1.28419433,  1.29553602,  1.29622153,  1.29737895,
#         1.29982318,  1.30951042,  1.31124033,  1.31216204,  1.31370652,
#         1.31688364,  1.32042477,  1.33318886,  1.33724669,  1.33840369,
#         1.3426076 ,  1.35283603,  1.36488405,  1.37113501,  1.3718494 ,
#         1.37511683,  1.37807958,  1.37846109,  1.3820262 ,  1.39449365,
#         1.40912065,  1.41224258,  1.41456084,  1.41535313,  1.42663224,
#         1.43088577,  1.43662039,  1.44167759,  1.44744653,  1.44756008,
#         1.45578935,  1.47555811,  1.47783322,  1.49348473,  1.49376879,
#         1.49410181,  1.49834412,  1.49915518,  1.49966208,  1.50213542,
#         1.50239445,  1.50363413,  1.50778418,  1.51805438,  1.52868492,
#         1.53772663,  1.54002703,  1.54005047,  1.543634  ,  1.55696768,
#         1.55731141,  1.57452065,  1.57851238,  1.58109691,  1.5865538 ,
#         1.58907544,  1.59172768,  1.59177567,  1.59237048,  1.59381265,
#         1.60490848,  1.60522856,  1.60615496,  1.60717275,  1.6093708 ,
#         1.61112394,  1.61183175,  1.61202871,  1.61933174,  1.62274263,
#         1.62674383,  1.6288618 ,  1.63173095,  1.63626314,  1.64202516,
#         1.64315   ,  1.64580367,  1.64732864,  1.64866205,  1.64884971,
#         1.65233805,  1.65728069,  1.65773703,  1.66071221,  1.66277508,
#         1.67378011,  1.67626693,  1.68224605,  1.68543312,  1.69380641,
#         1.69439077,  1.7017535 ,  1.71041768,  1.72017103,  1.72141923,
#         1.73090348,  1.73480733,  1.73897045,  1.74439177,  1.76327744,
#         1.77826033,  1.78306325,  1.78761949,  1.78927574,  1.79121198,
#         1.7952316 ,  1.79555698,  1.7975819 ,  1.79840572,  1.80797513,
#         1.81246112,  1.81664464,  1.82111051,  1.83289321,  1.83507833,
#         1.839929  ,  1.84000191,  1.84144225,  1.84832426,  1.85604408,
#         1.85657801,  1.85804643,  1.86009163,  1.86087858,  1.8650749 ,
#         1.86617778,  1.87233751,  1.87967803,  1.88125067,  1.89406467,
#         1.89840671,  1.90594876,  1.90746337,  1.91275263,  1.91912109,
#         1.93130213,  1.93669191,  1.94401853,  1.94701335,  1.94759806,
#         1.95308885,  1.95623584,  1.95870043,  1.96028199,  1.96817403,
#         1.9686119 ,  1.97592459,  1.97880455,  1.98082984,  1.98484073,
#         1.98567031,  1.98824576,  1.99207108,  2.00149461,  2.00152365,
#         2.00191476,  2.002327  ,  2.0033208 ,  2.01324176,  2.01487751,
#         2.01516578,  2.01687561,  2.01703988,  2.02055507,  2.02621596,
#         2.02952647,  2.03419618,  2.06196434,  2.06877545,  2.07626237,
#         2.08661287,  2.08778663,  2.08929079,  2.08973208,  2.09118517,
#         2.0914962 ,  2.09742807,  2.10607957,  2.11719938,  2.1174288 ,
#         2.11754112,  2.11951247,  2.12075352,  2.13541196,  2.13933737,
#         2.14705308,  2.15042514,  2.15177874,  2.15685688,  2.15979665,
#         2.16278599,  2.1645279 ,  2.18290287,  2.18342568,  2.18455086,
#         2.20149564,  2.21610248,  2.21796212,  2.21868565,  2.21873421,
#         2.22147399,  2.22300371,  2.2365463 ,  2.23711688,  2.24016766,
#         2.24383997,  2.24716446,  2.24737984,  2.25395978,  2.26076664,
#         2.26821949,  2.26927257,  2.2710843 ,  2.27248859,  2.27914358,
#         2.28168093,  2.29179837,  2.30082087,  2.30158015,  2.30671198,
#         2.30774622,  2.32012662,  2.32342943,  2.33189869,  2.33457749,
#         2.33871884,  2.33986392,  2.34886856,  2.34949968,  2.3526337 ,
#         2.35463541,  2.35745937,  2.36390154,  2.36711809,  2.36952788,
#         2.37180527,  2.38098927,  2.38188425,  2.38246067,  2.382797  ,
#         2.39104   ,  2.3951294 ,  2.40026605,  2.40189575,  2.40976574,
#         2.41416802,  2.41427235,  2.42293147,  2.43600513,  2.44140562,
#         2.44420015,  2.44600185,  2.44704527,  2.46005116,  2.46253358,
#         2.46391357,  2.47398662,  2.47455217,  2.47598933,  2.47924259,
#         2.48329184,  2.4926528 ,  2.49959398,  2.50837966,  2.51454678,
#         2.52099506,  2.52422719,  2.52508004,  2.53569853,  2.53716498,
#         2.54987654,  2.55276536,  2.56409432,  2.56455579,  2.57200266,
#         2.57492388,  2.57777993,  2.5825825 ,  2.59451743,  2.59636091,
#         2.59942621,  2.60755499,  2.61124823,  2.61344239,  2.63284554,
#         2.63381398,  2.63939802,  2.64258556,  2.64730144,  2.64795502,
#         2.64854352,  2.65334445,  2.65414013,  2.65518436,  2.65964692,
#         2.66011807,  2.66780702,  2.67026655,  2.67493459,  2.67652052,
#         2.68135714,  2.69515671,  2.70442847,  2.7157624 ,  2.72189958,
#         2.72236394,  2.73028325,  2.73226035,  2.73444874,  2.74295052,
#         2.74361518,  2.75481975,  2.75893817,  2.76091221,  2.76156208,
#         2.76443087,  2.76453047,  2.7665124 ,  2.77148363,  2.7861827 ,
#         2.78753765,  2.79218642,  2.79391732,  2.8004863 ,  2.80387499,
#         2.80636042,  2.80662763,  2.80714126,  2.81055306,  2.81723572,
#         2.82582117,  2.8376069 ,  2.83945977,  2.845281  ,  2.84927328,
#         2.84932135,  2.85657107,  2.86562346,  2.88601421,  2.88849828,
#         2.89868151,  2.90736257,  2.90771764,  2.90909113,  2.91204209,
#         2.91287118,  2.91555462,  2.91938412,  2.92734558,  2.93674436,
#         2.94573716,  2.94630712,  2.94683207,  2.94739759,  2.94817936,
#         2.95015113,  2.95517946,  2.96041339,  2.96953809,  2.97261243,
#         2.98322871,  2.98464979,  2.99623294,  2.99812139,  3.00410632,
#         3.0325285 ,  3.03488752,  3.04112815,  3.05134389,  3.0548235 ,
#         3.06108306,  3.06352431,  3.07553393,  3.08074691,  3.08352198,
#         3.11533106,  3.12370662,  3.12653643,  3.12664577,  3.13002862,
#         3.14420382,  3.16188664,  3.16334089,  3.18384448,  3.19681055,
#         3.1980126 ,  3.20076204,  3.2028828 ,  3.20380905,  3.22098515,
#         3.22413774,  3.25015147,  3.2648661 ,  3.28987708,  3.29317874,
#         3.29402419,  3.29611033,  3.29721168,  3.30046609,  3.30430301,
#         3.30984199,  3.3150808 ,  3.31563696,  3.32028385,  3.32186988,
#         3.32561439,  3.3339291 ,  3.34154013,  3.3443958 ,  3.34459571,
#         3.34536148,  3.34549141,  3.35199121,  3.36972117,  3.37093162,
#         3.37456181,  3.37732405,  3.3797282 ,  3.39727449,  3.39876313,
#         3.40452272,  3.40875871,  3.41673042,  3.41742681,  3.42539171,
#         3.42670047,  3.43024022,  3.4604001 ,  3.47284937,  3.53037284,
#         3.53635067,  3.54580521,  3.55748306,  3.5707199 ,  3.57986524,
#         3.58019033,  3.58059563,  3.58875286,  3.59395862,  3.59911354,
#         3.61992556,  3.63462031,  3.63488796,  3.6366703 ,  3.63790678,
#         3.6379256 ,  3.6418758 ,  3.66762067,  3.67071393,  3.6709326 ,
#         3.67786949,  3.68237616,  3.68855501,  3.70128149,  3.70421595,
#         3.7098393 ,  3.71728406,  3.71747641,  3.72072412,  3.73562671,
#         3.73943479,  3.75882836,  3.76818791,  3.76839741,  3.77601038,
#         3.78039079,  3.7877282 ,  3.80090333,  3.81159771,  3.81805587,
#         3.82619805,  3.83820474,  3.84272148,  3.84841658,  3.85748659,
#         3.86979875,  3.88261099,  3.88572689,  3.88619672,  3.89207948,
#         3.89833214,  3.91491388,  3.9190943 ,  3.92116681,  3.92558804,
#         3.94228527,  3.94944301,  3.95042598,  3.95662101,  3.96898602,
#         3.97073953,  3.97903484,  3.98344652,  3.99199201,  4.01171716,
#         4.03257954,  4.03586189,  4.03589257,  4.04554372,  4.06072101,
#         4.06312329,  4.06348782,  4.06840837,  4.07480458,  4.07605678,
#         4.08723985,  4.08981025,  4.09602117,  4.10185951,  4.10799767,
#         4.11002756,  4.12142803,  4.12527231,  4.1625132 ,  4.16563988,
#         4.17579188,  4.18326156,  4.19832538,  4.21883776,  4.22629859,
#         4.23625267,  4.2373601 ,  4.25692392,  4.27009078,  4.28540806,
#         4.28750157,  4.29235896,  4.31968078,  4.33233437,  4.34186813,
#         4.36300306,  4.37519228,  4.39042532,  4.41388975,  4.41900029,
#         4.42057665,  4.45697523,  4.46338415,  4.4736904 ,  4.49349042,
#         4.50883868,  4.53496165,  4.54394523,  4.54605589,  4.57703647,
#         4.60375554,  4.6248349 ,  4.63241936,  4.6378039 ,  4.63838479,
#         4.65071192,  4.68071176,  4.6921826 ,  4.72073375,  4.72310328,
#         4.72766549,  4.73729597,  4.74338182,  4.74819193,  4.75094047,
#         4.78352408,  4.79337219,  4.79513503,  4.80243861,  4.80876047,
#         4.80982392,  4.81012953,  4.81039228,  4.82026977,  4.83562072,
#         4.8534357 ,  4.85412659,  4.86287117,  4.86616244,  4.89951003,
#         4.93065864,  4.95635072,  4.96373242,  4.96741263,  4.98760414,
#         4.99000009,  4.99534889,  5.01240075,  5.05545588,  5.06092979,
#         5.07902556,  5.08152909,  5.08448999,  5.09356622,  5.1036029 ,
#         5.11103761,  5.13123771,  5.14481016,  5.1466162 ,  5.15157365,
#         5.17614898,  5.18451185,  5.19561662,  5.20605397,  5.22424043,
#         5.2917009 ,  5.29476735,  5.31807575,  5.31931542,  5.33332546,
#         5.33661905,  5.33877389,  5.34648431,  5.35861315,  5.38276398,
#         5.38623299,  5.43932312,  5.45012824,  5.45208211,  5.46676005,
#         5.50005334,  5.51568323,  5.5759153 ,  5.59382313,  5.64064087,
#         5.65554663,  5.70208871,  5.7220684 ,  5.73509462,  5.73972137,
#         5.75505976,  5.77253581,  5.84455606,  5.85284046,  5.8931716 ,
#         5.93375094,  6.08266032,  6.09216831,  6.132376  ,  6.14881459,
#         6.16747474,  6.20264488,  6.23815271,  6.28786836,  6.30272551,
#         6.30330541,  6.33771094,  6.35271717,  6.35615828,  6.3769681 ,
#         6.39695236,  6.41693122,  6.48819905,  6.49038299,  6.4943566 ,
#         6.55767699,  6.56431711,  6.61511731,  6.61777689,  6.66255493,
#         6.71357727,  6.71407566,  6.74309973,  6.87086473,  6.88893806,
#         6.88984393,  6.89667932,  6.91046743,  6.97380974,  6.97744958,
#         7.04805525,  7.08265278,  7.09258134,  7.1216742 ,  7.14462617,
#         7.17666689,  7.17838514,  7.2321599 ,  7.25928043,  7.29838903,
#         7.34983033,  7.39309362,  7.45073803,  7.46708916,  7.51752168,
#         7.55704292,  7.56999803,  7.61399119,  7.70009193,  7.72398101,
#         7.89968854,  8.02298946,  8.03577453,  8.16177618,  8.18475827,
#         8.30123303,  8.34219262,  8.37715454,  8.37947015,  8.3843384 ,
#         8.41561508,  8.4702624 ,  8.53647805,  8.54250891,  8.67692185,
#         8.91425721,  9.09224118,  9.15301959,  9.21856967,  9.24017778,
#         9.2870475 ,  9.53463793,  9.75049416, 10.25975403, 10.6692766 ,
#        10.8517106 , 11.47829887, 12.17130543, 12.84182012, 12.92250595])

# ASSET NULL DIST: 

# np.array([ 0.02760192,  0.07641301,  0.07646574,  0.08882622,  0.10148437,
#         0.10148912,  0.10220392,  0.10541883,  0.11443461,  0.12014419,
#         0.12985592,  0.13383053,  0.15457302,  0.19498952,  0.19898119,
#         0.19916984,  0.20234772,  0.2151727 ,  0.21620366,  0.22543311,
#         0.22773271,  0.22965331,  0.24425572,  0.24446917,  0.25833408,
#         0.25858046,  0.26117991,  0.26125821,  0.26446872,  0.2650453 ,
#         0.29303007,  0.29685678,  0.29699965,  0.29744588,  0.30112367,
#         0.30384872,  0.31243246,  0.31587323,  0.31777955,  0.3190226 ,
#         0.32058798,  0.32192306,  0.3279592 ,  0.32815363,  0.33410212,
#         0.33758449,  0.34472949,  0.34507633,  0.34633101,  0.34799827,
#         0.3483091 ,  0.34889683,  0.3502795 ,  0.35444877,  0.36901778,
#         0.37462879,  0.37659294,  0.38550723,  0.38879169,  0.39017184,
#         0.39107855,  0.39271929,  0.40025481,  0.40060988,  0.40764664,
#         0.40884937,  0.41038857,  0.41072555,  0.41155934,  0.41480049,
#         0.41886186,  0.42907291,  0.42975037,  0.43343301,  0.43390696,
#         0.43829542,  0.44867587,  0.45835074,  0.45946195,  0.47031899,
#         0.47278371,  0.47549593,  0.47901166,  0.48005008,  0.48244109,
#         0.48981371,  0.49108774,  0.4988056 ,  0.50025458,  0.50985737,
#         0.51309702,  0.51574341,  0.51996405,  0.52456219,  0.52519774,
#         0.52715437,  0.52830857,  0.53594137,  0.53685136,  0.55082597,
#         0.55164015,  0.55676373,  0.55713027,  0.55811939,  0.56051167,
#         0.56077951,  0.56539447,  0.57798797,  0.58209917,  0.58777093,
#         0.59683631,  0.59865658,  0.60195136,  0.60763011,  0.61150995,
#         0.61361833,  0.61630339,  0.61715603,  0.62101736,  0.62532889,
#         0.62542701,  0.63464089,  0.63656489,  0.6399695 ,  0.64009206,
#         0.64450124,  0.65488819,  0.65928742,  0.66065002,  0.66065047,
#         0.66382858,  0.66791621,  0.67282896,  0.67694387,  0.67826841,
#         0.68610528,  0.6906877 ,  0.69412346,  0.69553091,  0.70124346,
#         0.7060743 ,  0.70682815,  0.72445101,  0.7256187 ,  0.7295753 ,
#         0.73223261,  0.73447765,  0.7456349 ,  0.74772849,  0.76147047,
#         0.76872371,  0.77163621,  0.78380547,  0.78465851,  0.78563488,
#         0.7918614 ,  0.79424334,  0.8003757 ,  0.81629563,  0.81716023,
#         0.83894828,  0.84317513,  0.84429483,  0.84796003,  0.85163259,
#         0.85531558,  0.86011734,  0.86498971,  0.87029038,  0.87836965,
#         0.87886855,  0.88057256,  0.88447187,  0.88665367,  0.88816085,
#         0.89002379,  0.89056088,  0.89110585,  0.89458241,  0.8969722 ,
#         0.89756158,  0.90724561,  0.90948033,  0.91264363,  0.91887552,
#         0.92353765,  0.92726197,  0.93497926,  0.93819827,  0.93947606,
#         0.95094705,  0.95104052,  0.95854396,  0.95876338,  0.97323161,
#         0.97483057,  0.98719924,  0.98920362,  0.99598161,  0.99805076,
#         1.00107838,  1.0037022 ,  1.01804914,  1.02237601,  1.0253931 ,
#         1.02586037,  1.02630422,  1.03165823,  1.03202197,  1.03362689,
#         1.03533817,  1.03735529,  1.03908117,  1.04341943,  1.0465482 ,
#         1.05344945,  1.06007779,  1.0637014 ,  1.06390051,  1.07550522,
#         1.0756664 ,  1.07999687,  1.08142261,  1.10166002,  1.10452167,
#         1.10739704,  1.1085184 ,  1.11593344,  1.11913435,  1.12004634,
#         1.12063771,  1.12449639,  1.12945264,  1.13016751,  1.13756775,
#         1.14062869,  1.14603845,  1.1511618 ,  1.15184044,  1.15221082,
#         1.15245656,  1.15586503,  1.15863585,  1.1621807 ,  1.16268012,
#         1.16668184,  1.16982233,  1.17439306,  1.1744712 ,  1.17867922,
#         1.1917037 ,  1.19625647,  1.19747694,  1.19850001,  1.20473836,
#         1.20594221,  1.20950318,  1.20986283,  1.21193307,  1.21744836,
#         1.22386706,  1.2248645 ,  1.22577326,  1.2273161 ,  1.23199191,
#         1.23461792,  1.24177362,  1.24769849,  1.25222367,  1.2569266 ,
#         1.26969234,  1.27219383,  1.27500434,  1.2754099 ,  1.2779912 ,
#         1.27892438,  1.28248513,  1.28251822,  1.30136536,  1.30409155,
#         1.30780885,  1.30867681,  1.31097778,  1.31888117,  1.31892861,
#         1.32232636,  1.32420214,  1.33471478,  1.33586548,  1.3370013 ,
#         1.33845591,  1.33916951,  1.34731573,  1.38400463,  1.38429597,
#         1.40685213,  1.40717186,  1.41004606,  1.41011042,  1.418056  ,
#         1.43147062,  1.43315311,  1.43391432,  1.4374636 ,  1.44127631,
#         1.44670533,  1.4476068 ,  1.45180314,  1.45729707,  1.46193115,
#         1.46460281,  1.46748944,  1.46993255,  1.47034581,  1.47194806,
#         1.48261477,  1.48494946,  1.48706945,  1.49238845,  1.49438839,
#         1.50182155,  1.50589379,  1.50796862,  1.51349572,  1.51597405,
#         1.52523826,  1.52956524,  1.5354439 ,  1.53830579,  1.53997643,
#         1.55220819,  1.55350465,  1.55654602,  1.55716188,  1.55739386,
#         1.56018553,  1.57188496,  1.5726943 ,  1.5797901 ,  1.58001766,
#         1.58056791,  1.58101856,  1.59000919,  1.61265455,  1.61794219,
#         1.62181842,  1.62266929,  1.62426936,  1.6249559 ,  1.63603885,
#         1.63942832,  1.64222539,  1.64630546,  1.64775844,  1.65157838,
#         1.65188642,  1.65577628,  1.66173312,  1.66847319,  1.6693424 ,
#         1.67604663,  1.68669642,  1.68816687,  1.6884323 ,  1.69005234,
#         1.69294565,  1.69390305,  1.69481585,  1.69515955,  1.70194329,
#         1.70401996,  1.70484476,  1.72809764,  1.7397063 ,  1.74452498,
#         1.75134786,  1.75352904,  1.75839757,  1.76192242,  1.77248934,
#         1.77323624,  1.77373622,  1.7783165 ,  1.77986224,  1.78562555,
#         1.78799429,  1.78925311,  1.79442773,  1.79509755,  1.80993814,
#         1.82546824,  1.82947867,  1.83112211,  1.831795  ,  1.83208987,
#         1.84480008,  1.84500538,  1.84904813,  1.85006107,  1.85615311,
#         1.85679419,  1.86247821,  1.87562937,  1.87661881,  1.8805123 ,
#         1.88488283,  1.8878663 ,  1.89356633,  1.89716532,  1.89918824,
#         1.90619349,  1.90810591,  1.90850537,  1.91031227,  1.9188309 ,
#         1.9209323 ,  1.92294872,  1.93132271,  1.9350962 ,  1.93813326,
#         1.93845207,  1.93985137,  1.94207184,  1.94839855,  1.94883059,
#         1.95262484,  1.9552918 ,  1.95968256,  1.96529995,  1.96864385,
#         1.97032485,  1.97493005,  1.97606672,  1.97632428,  1.97980487,
#         1.98264369,  1.98466194,  1.98582329,  1.98760698,  1.99170465,
#         1.99471718,  1.9948462 ,  2.00183036,  2.00595921,  2.00713294,
#         2.00747231,  2.0137828 ,  2.01706137,  2.01951723,  2.02261024,
#         2.02491787,  2.03361113,  2.03813546,  2.04816216,  2.04876524,
#         2.05208372,  2.05475705,  2.05573458,  2.06230223,  2.06594931,
#         2.06680748,  2.06794694,  2.06994445,  2.07202454,  2.07277795,
#         2.08511786,  2.09440554,  2.09686935,  2.10140907,  2.10165225,
#         2.10912497,  2.11991874,  2.12366174,  2.12484609,  2.1253355 ,
#         2.12862575,  2.14947685,  2.1532847 ,  2.16036243,  2.16702981,
#         2.18935599,  2.20043903,  2.20257814,  2.20868769,  2.21053768,
#         2.21874802,  2.218849  ,  2.223538  ,  2.22625115,  2.22880201,
#         2.23519123,  2.23672164,  2.24668375,  2.25377125,  2.26102373,
#         2.26112936,  2.26558054,  2.26702648,  2.27090313,  2.27542468,
#         2.27792221,  2.28530537,  2.3011806 ,  2.30799674,  2.31323593,
#         2.31672947,  2.31690707,  2.32133772,  2.33279407,  2.34167243,
#         2.34472482,  2.3484875 ,  2.35560115,  2.36807132,  2.37302204,
#         2.37452718,  2.37664596,  2.38271362,  2.38304277,  2.39090258,
#         2.39563373,  2.39879035,  2.40124123,  2.40159131,  2.41196856,
#         2.42238143,  2.43059071,  2.46088547,  2.46589698,  2.46871153,
#         2.47862092,  2.48574429,  2.49395874,  2.49738317,  2.50034759,
#         2.50656451,  2.51000793,  2.51385785,  2.51809558,  2.51849879,
#         2.52596083,  2.52804894,  2.52812745,  2.53068539,  2.53745772,
#         2.54088331,  2.55428381,  2.55781121,  2.56188419,  2.56573867,
#         2.57125494,  2.57454163,  2.59090448,  2.59642418,  2.60512617,
#         2.61515357,  2.61737075,  2.6223281 ,  2.62743061,  2.63385218,
#         2.63661248,  2.63784003,  2.64296916,  2.64459732,  2.65498728,
#         2.65705812,  2.67561757,  2.67637769,  2.70076956,  2.70151351,
#         2.70174948,  2.71106924,  2.71952748,  2.72458193,  2.73878599,
#         2.74693711,  2.75462491,  2.75470855,  2.76806729,  2.77217196,
#         2.78177876,  2.78228836,  2.78734566,  2.79508783,  2.79582575,
#         2.80724677,  2.80732141,  2.81008777,  2.81441518,  2.82040735,
#         2.82318291,  2.83006489,  2.83230743,  2.83591706,  2.8407286 ,
#         2.84850475,  2.8522462 ,  2.86471145,  2.86583943,  2.86712658,
#         2.87021092,  2.87127145,  2.87263121,  2.87358985,  2.87754252,
#         2.89319214,  2.89833081,  2.90884844,  2.9154904 ,  2.92682186,
#         2.95776396,  2.95918787,  2.96147627,  2.9677398 ,  2.97225816,
#         2.97528419,  2.98029322,  2.99072232,  2.99496335,  2.99827935,
#         3.00412618,  3.00633471,  3.01041922,  3.01146334,  3.01164522,
#         3.01269342,  3.01577321,  3.02405673,  3.02839096,  3.03681558,
#         3.03842843,  3.04777316,  3.06016644,  3.06052028,  3.06220461,
#         3.06557313,  3.06744225,  3.06916332,  3.07038358,  3.07392929,
#         3.08340455,  3.08585545,  3.09734822,  3.10311459,  3.10487994,
#         3.10910144,  3.11349528,  3.12336525,  3.12609653,  3.1396827 ,
#         3.14477564,  3.15217287,  3.15238541,  3.15257013,  3.15318072,
#         3.16901049,  3.1728877 ,  3.17620775,  3.18935371,  3.19519002,
#         3.1953147 ,  3.20402318,  3.20790121,  3.21681353,  3.21971735,
#         3.22236077,  3.22295573,  3.22333968,  3.22394452,  3.24044749,
#         3.24345787,  3.25605143,  3.26232271,  3.26299235,  3.26386266,
#         3.26820511,  3.27129856,  3.27354936,  3.28385375,  3.28807688,
#         3.30116755,  3.30339495,  3.30863448,  3.3263823 ,  3.32845848,
#         3.34197366,  3.34732077,  3.35652864,  3.3616381 ,  3.37254215,
#         3.37323139,  3.37974639,  3.41272242,  3.42343679,  3.44918294,
#         3.45001311,  3.46218394,  3.46693268,  3.46695149,  3.47781282,
#         3.48553723,  3.48916021,  3.49482065,  3.51679799,  3.53288653,
#         3.53602238,  3.54783971,  3.54841466,  3.55380433,  3.5569933 ,
#         3.57810763,  3.58073418,  3.58886143,  3.59426088,  3.59606526,
#         3.5969734 ,  3.60177212,  3.6071362 ,  3.61273773,  3.62769081,
#         3.63223423,  3.63303685,  3.63430979,  3.64402976,  3.64895977,
#         3.65766535,  3.66427283,  3.66902228,  3.67224966,  3.67982068,
#         3.69818586,  3.70537493,  3.7163895 ,  3.7320521 ,  3.73590846,
#         3.74418236,  3.74734121,  3.75443244,  3.75887279,  3.77286198,
#         3.77423255,  3.77551112,  3.77651589,  3.78340079,  3.78659986,
#         3.78971205,  3.80805193,  3.81804151,  3.82396602,  3.86074316,
#         3.86933177,  3.87067773,  3.87470194,  3.87919223,  3.88200881,
#         3.91063854,  3.93706861,  3.93724149,  3.93732489,  3.94108647,
#         3.95175796,  3.95364681,  3.9577249 ,  3.99753788,  4.00640291,
#         4.01431147,  4.04153825,  4.04849241,  4.0596472 ,  4.06100095,
#         4.06212665,  4.0718903 ,  4.07467717,  4.10656756,  4.11895726,
#         4.12034653,  4.13901487,  4.15554655,  4.20550563,  4.20997115,
#         4.22704868,  4.22723944,  4.22846618,  4.23827254,  4.24307569,
#         4.26688578,  4.27000007,  4.27759608,  4.27926153,  4.31261488,
#         4.31857905,  4.32688778,  4.35048988,  4.37506282,  4.37702317,
#         4.38701263,  4.39560839,  4.41156445,  4.44917665,  4.44952125,
#         4.45634549,  4.49632346,  4.52720095,  4.53622081,  4.56175454,
#         4.5793595 ,  4.58560521,  4.60498183,  4.60750434,  4.62488807,
#         4.63721244,  4.63846661,  4.63935978,  4.66956389,  4.67280784,
#         4.67819512,  4.73280039,  4.74009747,  4.74873762,  4.77556764,
#         4.80685724,  4.82463144,  4.82575328,  4.83223692,  4.85047754,
#         4.85522241,  4.86514708,  4.86825029,  4.88541202,  4.88768613,
#         4.91293697,  4.92908023,  4.92998335,  4.95709733,  4.97345533,
#         4.98469581,  4.99491517,  5.00165512,  5.02605709,  5.03926027,
#         5.05861145,  5.06305643,  5.08647267,  5.09546989,  5.09739587,
#         5.12191125,  5.13171096,  5.13269167,  5.19297624,  5.20975739,
#         5.22174861,  5.23482086,  5.24408879,  5.253093  ,  5.2896689 ,
#         5.32444894,  5.33635704,  5.38302014,  5.38739968,  5.3944057 ,
#         5.41052705,  5.43832752,  5.46399375,  5.47165054,  5.55792201,
#         5.57840833,  5.59153462,  5.65047667,  5.67944013,  5.68111969,
#         5.68813906,  5.68897412,  5.70368316,  5.71633304,  5.71829773,
#         5.75528331,  5.75782382,  5.78442815,  5.78773957,  5.78924038,
#         5.79443617,  5.79991417,  5.80005666,  5.82731847,  5.84863911,
#         5.85006699,  5.86547626,  5.88347364,  5.90663663,  5.91157844,
#         5.91559208,  5.93659414,  5.96165322,  5.96304792,  5.96373001,
#         5.96944194,  5.98986505,  5.9929805 ,  6.03410795,  6.03859321,
#         6.10097161,  6.11738792,  6.11813482,  6.12512188,  6.13174157,
#         6.13422585,  6.16566825,  6.166079  ,  6.17113046,  6.20632037,
#         6.22362118,  6.24231332,  6.25955839,  6.26633067,  6.32175131,
#         6.33283931,  6.33839657,  6.36648954,  6.40882829,  6.4647226 ,
#         6.46702365,  6.50125389,  6.50916775,  6.52173976,  6.59338427,
#         6.60090175,  6.61854242,  6.6601492 ,  6.66733869,  6.70793993,
#         6.75751861,  6.76365508,  6.79426174,  6.83141801,  6.84440813,
#         6.85208031,  6.90270718,  6.90527456,  6.90934593,  6.91233475,
#         6.93039854,  6.93740245,  7.06526315,  7.12152226,  7.1528475 ,
#         7.17681171,  7.18290116,  7.20360291,  7.20361022,  7.30302383,
#         7.35930876,  7.36215359,  7.4035983 ,  7.41047427,  7.42596329,
#         7.42611507,  7.43112994,  7.50162817,  7.52691935,  7.53797173,
#         7.55213497,  7.56193127,  7.6142108 ,  7.62516767,  7.67170645,
#         7.677741  ,  7.68968078,  7.85017014,  7.9528973 ,  8.14308203,
#         8.26337506,  8.28087747,  8.30282437,  8.32355087,  8.38534186,
#         8.47232383,  8.56515558,  8.62470124,  8.67425463,  8.91501816,
#         9.18478746,  9.28453564,  9.39080875,  9.46538115,  9.6285117 ,
#        10.02837075, 10.12495326, 10.27829293, 10.42150374, 10.46345835,
#        10.77969833, 10.92601841, 11.38865722, 11.6397466 , 11.96897257,
#        12.50733318, 13.09215982, 13.74772272, 14.32571229, 14.63890631])